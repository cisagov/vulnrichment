{
  "dataType": "CVE_RECORD",
  "dataVersion": "5.1",
  "cveMetadata": {
    "cveId": "CVE-2021-47185",
    "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
    "state": "PUBLISHED",
    "assignerShortName": "Linux",
    "dateReserved": "2024-03-25T09:12:14.113Z",
    "datePublished": "2024-04-10T18:56:25.671Z",
    "dateUpdated": "2024-06-04T17:14:18.411Z"
  },
  "containers": {
    "cna": {
      "providerMetadata": {
        "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "shortName": "Linux",
        "dateUpdated": "2024-05-29T05:03:32.160Z"
      },
      "descriptions": [
        {
          "lang": "en",
          "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ntty: tty_buffer: Fix the softlockup issue in flush_to_ldisc\n\nWhen running ltp testcase(ltp/testcases/kernel/pty/pty04.c) with arm64, there is a soft lockup,\nwhich look like this one:\n\n  Workqueue: events_unbound flush_to_ldisc\n  Call trace:\n   dump_backtrace+0x0/0x1ec\n   show_stack+0x24/0x30\n   dump_stack+0xd0/0x128\n   panic+0x15c/0x374\n   watchdog_timer_fn+0x2b8/0x304\n   __run_hrtimer+0x88/0x2c0\n   __hrtimer_run_queues+0xa4/0x120\n   hrtimer_interrupt+0xfc/0x270\n   arch_timer_handler_phys+0x40/0x50\n   handle_percpu_devid_irq+0x94/0x220\n   __handle_domain_irq+0x88/0xf0\n   gic_handle_irq+0x84/0xfc\n   el1_irq+0xc8/0x180\n   slip_unesc+0x80/0x214 [slip]\n   tty_ldisc_receive_buf+0x64/0x80\n   tty_port_default_receive_buf+0x50/0x90\n   flush_to_ldisc+0xbc/0x110\n   process_one_work+0x1d4/0x4b0\n   worker_thread+0x180/0x430\n   kthread+0x11c/0x120\n\nIn the testcase pty04, The first process call the write syscall to send\ndata to the pty master. At the same time, the workqueue will do the\nflush_to_ldisc to pop data in a loop until there is no more data left.\nWhen the sender and workqueue running in different core, the sender sends\ndata fastly in full time which will result in workqueue doing work in loop\nfor a long time and occuring softlockup in flush_to_ldisc with kernel\nconfigured without preempt. So I add need_resched check and cond_resched\nin the flush_to_ldisc loop to avoid it."
        }
      ],
      "affected": [
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "unaffected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "drivers/tty/tty_buffer.c"
          ],
          "versions": [
            {
              "version": "1da177e4c3f4",
              "lessThan": "0380f643f3a7",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "b1ffc16ec05a",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "4c1623651a09",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "4f300f47dbcf",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "d491c84df5c4",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "77e9fed33056",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "5c34486f0470",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "3968ddcf05fb",
              "status": "affected",
              "versionType": "git"
            }
          ]
        },
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "affected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "drivers/tty/tty_buffer.c"
          ],
          "versions": [
            {
              "version": "4.4.293",
              "lessThanOrEqual": "4.4.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "4.9.291",
              "lessThanOrEqual": "4.9.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "4.14.256",
              "lessThanOrEqual": "4.14.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "4.19.218",
              "lessThanOrEqual": "4.19.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "5.4.162",
              "lessThanOrEqual": "5.4.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "5.10.82",
              "lessThanOrEqual": "5.10.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "5.15.5",
              "lessThanOrEqual": "5.15.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "5.16",
              "lessThanOrEqual": "*",
              "status": "unaffected",
              "versionType": "original_commit_for_fix"
            }
          ]
        }
      ],
      "references": [
        {
          "url": "https://git.kernel.org/stable/c/0380f643f3a7a61b0845cdc738959c2ad5735d61"
        },
        {
          "url": "https://git.kernel.org/stable/c/b1ffc16ec05ae40d82b6e373322d62e9d6b54fbc"
        },
        {
          "url": "https://git.kernel.org/stable/c/4c1623651a0936ee197859824cdae6ebbd04d3ed"
        },
        {
          "url": "https://git.kernel.org/stable/c/4f300f47dbcf9c3d4b2ea76c8554c8f360400725"
        },
        {
          "url": "https://git.kernel.org/stable/c/d491c84df5c469dd9621863b6a770b3428137063"
        },
        {
          "url": "https://git.kernel.org/stable/c/77e9fed33056f2a88eba9dd4d2d5412f0c7d1f41"
        },
        {
          "url": "https://git.kernel.org/stable/c/5c34486f04700f1ba04907231dce0cc2705c2d7d"
        },
        {
          "url": "https://git.kernel.org/stable/c/3968ddcf05fb4b9409cd1859feb06a5b0550a1c1"
        }
      ],
      "title": "tty: tty_buffer: Fix the softlockup issue in flush_to_ldisc",
      "x_generator": {
        "engine": "bippy-a5840b7849dd"
      }
    },
    "adp": [
      {
        "metrics": [
          {
            "other": {
              "type": "ssvc",
              "content": {
                "id": "CVE-2021-47185",
                "role": "CISA Coordinator",
                "options": [
                  {
                    "Exploitation": "none"
                  },
                  {
                    "Automatable": "no"
                  },
                  {
                    "Technical Impact": "partial"
                  }
                ],
                "version": "2.0.3",
                "timestamp": "2024-04-15T14:53:32.237242Z"
              }
            }
          }
        ],
        "providerMetadata": {
          "orgId": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
          "shortName": "CISA-ADP",
          "dateUpdated": "2024-05-23T19:01:23.742Z"
        },
        "title": "CISA ADP Vulnrichment"
      }
    ]
  }
}