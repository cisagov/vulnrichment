{
  "dataType": "CVE_RECORD",
  "dataVersion": "5.1",
  "cveMetadata": {
    "cveId": "CVE-2021-47458",
    "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
    "state": "PUBLISHED",
    "assignerShortName": "Linux",
    "dateReserved": "2024-05-21T14:58:30.833Z",
    "datePublished": "2024-05-22T06:19:46.675Z",
    "dateUpdated": "2024-06-10T18:55:34.667Z"
  },
  "containers": {
    "cna": {
      "providerMetadata": {
        "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "shortName": "Linux",
        "dateUpdated": "2024-05-29T05:08:17.651Z"
      },
      "descriptions": [
        {
          "lang": "en",
          "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nocfs2: mount fails with buffer overflow in strlen\n\nStarting with kernel 5.11 built with CONFIG_FORTIFY_SOURCE mouting an\nocfs2 filesystem with either o2cb or pcmk cluster stack fails with the\ntrace below.  Problem seems to be that strings for cluster stack and\ncluster name are not guaranteed to be null terminated in the disk\nrepresentation, while strlcpy assumes that the source string is always\nnull terminated.  This causes a read outside of the source string\ntriggering the buffer overflow detection.\n\n  detected buffer overflow in strlen\n  ------------[ cut here ]------------\n  kernel BUG at lib/string.c:1149!\n  invalid opcode: 0000 [#1] SMP PTI\n  CPU: 1 PID: 910 Comm: mount.ocfs2 Not tainted 5.14.0-1-amd64 #1\n    Debian 5.14.6-2\n  RIP: 0010:fortify_panic+0xf/0x11\n  ...\n  Call Trace:\n   ocfs2_initialize_super.isra.0.cold+0xc/0x18 [ocfs2]\n   ocfs2_fill_super+0x359/0x19b0 [ocfs2]\n   mount_bdev+0x185/0x1b0\n   legacy_get_tree+0x27/0x40\n   vfs_get_tree+0x25/0xb0\n   path_mount+0x454/0xa20\n   __x64_sys_mount+0x103/0x140\n   do_syscall_64+0x3b/0xc0\n   entry_SYSCALL_64_after_hwframe+0x44/0xae"
        }
      ],
      "affected": [
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "unaffected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "fs/ocfs2/super.c"
          ],
          "versions": [
            {
              "version": "1da177e4c3f4",
              "lessThan": "ac011cb3ff7a",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "4b74ddcc22ee",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "232ed9752510",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "7623b1035ca2",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "d3a83576378b",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "93be0eeea14c",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "0e677ea5b739",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "b15fa9224e6e",
              "status": "affected",
              "versionType": "git"
            }
          ]
        },
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "affected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "fs/ocfs2/super.c"
          ],
          "versions": [
            {
              "version": "4.4.290",
              "lessThanOrEqual": "4.4.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "4.9.288",
              "lessThanOrEqual": "4.9.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "4.14.253",
              "lessThanOrEqual": "4.14.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "4.19.214",
              "lessThanOrEqual": "4.19.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "5.4.156",
              "lessThanOrEqual": "5.4.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "5.10.76",
              "lessThanOrEqual": "5.10.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "5.14.15",
              "lessThanOrEqual": "5.14.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "5.15",
              "lessThanOrEqual": "*",
              "status": "unaffected",
              "versionType": "original_commit_for_fix"
            }
          ]
        }
      ],
      "references": [
        {
          "url": "https://git.kernel.org/stable/c/ac011cb3ff7a76b3e0e6e77158ee4ba2f929e1fb"
        },
        {
          "url": "https://git.kernel.org/stable/c/4b74ddcc22ee6455946e80a9c4808801f8f8561e"
        },
        {
          "url": "https://git.kernel.org/stable/c/232ed9752510de4436468b653d145565669c8498"
        },
        {
          "url": "https://git.kernel.org/stable/c/7623b1035ca2d17bde0f6a086ad6844a34648df1"
        },
        {
          "url": "https://git.kernel.org/stable/c/d3a83576378b4c904f711598dde2c5e881c4295c"
        },
        {
          "url": "https://git.kernel.org/stable/c/93be0eeea14cf39235e585c8f56df3b3859deaad"
        },
        {
          "url": "https://git.kernel.org/stable/c/0e677ea5b7396f715a76b6b0ef441430e4c4b57f"
        },
        {
          "url": "https://git.kernel.org/stable/c/b15fa9224e6e1239414525d8d556d824701849fc"
        }
      ],
      "title": "ocfs2: mount fails with buffer overflow in strlen",
      "x_generator": {
        "engine": "bippy-a5840b7849dd"
      }
    },
    "adp": [
      {
        "title": "CISA ADP Vulnrichment",
        "metrics": [
          {
            "other": {
              "type": "ssvc",
              "content": {
                "id": "CVE-2021-47458",
                "role": "CISA Coordinator",
                "options": [
                  {
                    "Exploitation": "none"
                  },
                  {
                    "Automatable": "no"
                  },
                  {
                    "Technical Impact": "partial"
                  }
                ],
                "version": "2.0.3",
                "timestamp": "2024-06-10T18:55:25.437565Z"
              }
            }
          }
        ],
        "providerMetadata": {
          "orgId": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
          "shortName": "CISA-ADP",
          "dateUpdated": "2024-06-10T18:55:31.951Z"
        }
      }
    ]
  }
}