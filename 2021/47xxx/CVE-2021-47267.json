{
  "dataType": "CVE_RECORD",
  "dataVersion": "5.1",
  "cveMetadata": {
    "cveId": "CVE-2021-47267",
    "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
    "state": "PUBLISHED",
    "assignerShortName": "Linux",
    "dateReserved": "2024-05-21T13:27:52.127Z",
    "datePublished": "2024-05-21T14:19:57.894Z",
    "dateUpdated": "2024-06-04T17:15:22.018Z"
  },
  "containers": {
    "cna": {
      "providerMetadata": {
        "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "shortName": "Linux",
        "dateUpdated": "2024-05-29T05:04:58.512Z"
      },
      "descriptions": [
        {
          "lang": "en",
          "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nusb: fix various gadget panics on 10gbps cabling\n\nusb_assign_descriptors() is called with 5 parameters,\nthe last 4 of which are the usb_descriptor_header for:\n  full-speed (USB1.1 - 12Mbps [including USB1.0 low-speed @ 1.5Mbps),\n  high-speed (USB2.0 - 480Mbps),\n  super-speed (USB3.0 - 5Gbps),\n  super-speed-plus (USB3.1 - 10Gbps).\n\nThe differences between full/high/super-speed descriptors are usually\nsubstantial (due to changes in the maximum usb block size from 64 to 512\nto 1024 bytes and other differences in the specs), while the difference\nbetween 5 and 10Gbps descriptors may be as little as nothing\n(in many cases the same tuning is simply good enough).\n\nHowever if a gadget driver calls usb_assign_descriptors() with\na NULL descriptor for super-speed-plus and is then used on a max 10gbps\nconfiguration, the kernel will crash with a null pointer dereference,\nwhen a 10gbps capable device port + cable + host port combination shows up.\n(This wouldn't happen if the gadget max-speed was set to 5gbps, but\nit of course defaults to the maximum, and there's no real reason to\nartificially limit it)\n\nThe fix is to simply use the 5gbps descriptor as the 10gbps descriptor,\nif a 10gbps descriptor wasn't provided.\n\nObviously this won't fix the problem if the 5gbps descriptor is also\nNULL, but such cases can't be so trivially solved (and any such gadgets\nare unlikely to be used with USB3 ports any way)."
        }
      ],
      "affected": [
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "unaffected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "drivers/usb/gadget/config.c"
          ],
          "versions": [
            {
              "version": "1da177e4c3f4",
              "lessThan": "fd24be23abf3",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "70cd19cb5bd9",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "45f9a2fe737d",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "5ef23506695b",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "b972eff87463",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "ca6bc277430d",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "032e288097a5",
              "status": "affected",
              "versionType": "git"
            }
          ]
        },
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "affected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "drivers/usb/gadget/config.c"
          ],
          "versions": [
            {
              "version": "4.9.273",
              "lessThanOrEqual": "4.9.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "4.14.237",
              "lessThanOrEqual": "4.14.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "4.19.195",
              "lessThanOrEqual": "4.19.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "5.4.126",
              "lessThanOrEqual": "5.4.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "5.10.44",
              "lessThanOrEqual": "5.10.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "5.12.11",
              "lessThanOrEqual": "5.12.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "5.13",
              "lessThanOrEqual": "*",
              "status": "unaffected",
              "versionType": "original_commit_for_fix"
            }
          ]
        }
      ],
      "references": [
        {
          "url": "https://git.kernel.org/stable/c/fd24be23abf3e94260be0f00bb42c7e91d495f87"
        },
        {
          "url": "https://git.kernel.org/stable/c/70cd19cb5bd94bbb5bacfc9c1e4ee0071699a604"
        },
        {
          "url": "https://git.kernel.org/stable/c/45f9a2fe737dc0a5df270787f2231aee8985cd59"
        },
        {
          "url": "https://git.kernel.org/stable/c/5ef23506695b01d5d56a13a092a97f2478069d75"
        },
        {
          "url": "https://git.kernel.org/stable/c/b972eff874637402ddc4a7dd11fb22538a0b6d28"
        },
        {
          "url": "https://git.kernel.org/stable/c/ca6bc277430d90375452b60b047763a090b7673e"
        },
        {
          "url": "https://git.kernel.org/stable/c/032e288097a553db5653af552dd8035cd2a0ba96"
        }
      ],
      "title": "usb: fix various gadget panics on 10gbps cabling",
      "x_generator": {
        "engine": "bippy-a5840b7849dd"
      }
    },
    "adp": [
      {
        "metrics": [
          {
            "other": {
              "type": "ssvc",
              "content": {
                "id": "CVE-2021-47267",
                "role": "CISA Coordinator",
                "options": [
                  {
                    "Exploitation": "none"
                  },
                  {
                    "Automatable": "no"
                  },
                  {
                    "Technical Impact": "partial"
                  }
                ],
                "version": "2.0.3",
                "timestamp": "2024-05-21T18:49:52.112384Z"
              }
            }
          }
        ],
        "providerMetadata": {
          "orgId": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
          "shortName": "CISA-ADP",
          "dateUpdated": "2024-05-23T19:01:25.502Z"
        },
        "title": "CISA ADP Vulnrichment"
      }
    ]
  }
}