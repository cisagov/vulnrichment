{
  "dataType": "CVE_RECORD",
  "dataVersion": "5.1",
  "cveMetadata": {
    "cveId": "CVE-2021-47114",
    "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
    "state": "PUBLISHED",
    "assignerShortName": "Linux",
    "dateReserved": "2024-03-04T18:12:48.836Z",
    "datePublished": "2024-03-15T20:14:22.035Z",
    "dateUpdated": "2024-06-04T17:15:09.308Z"
  },
  "containers": {
    "cna": {
      "providerMetadata": {
        "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "shortName": "Linux",
        "dateUpdated": "2024-05-29T05:02:21.422Z"
      },
      "descriptions": [
        {
          "lang": "en",
          "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nocfs2: fix data corruption by fallocate\n\nWhen fallocate punches holes out of inode size, if original isize is in\nthe middle of last cluster, then the part from isize to the end of the\ncluster will be zeroed with buffer write, at that time isize is not yet\nupdated to match the new size, if writeback is kicked in, it will invoke\nocfs2_writepage()->block_write_full_page() where the pages out of inode\nsize will be dropped.  That will cause file corruption.  Fix this by\nzero out eof blocks when extending the inode size.\n\nRunning the following command with qemu-image 4.2.1 can get a corrupted\ncoverted image file easily.\n\n    qemu-img convert -p -t none -T none -f qcow2 $qcow_image \\\n             -O qcow2 -o compat=1.1 $qcow_image.conv\n\nThe usage of fallocate in qemu is like this, it first punches holes out\nof inode size, then extend the inode size.\n\n    fallocate(11, FALLOC_FL_KEEP_SIZE|FALLOC_FL_PUNCH_HOLE, 2276196352, 65536) = 0\n    fallocate(11, 0, 2276196352, 65536) = 0\n\nv1: https://www.spinics.net/lists/linux-fsdevel/msg193999.html\nv2: https://lore.kernel.org/linux-fsdevel/20210525093034.GB4112@quack2.suse.cz/T/"
        }
      ],
      "affected": [
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "unaffected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "fs/ocfs2/file.c"
          ],
          "versions": [
            {
              "version": "1da177e4c3f4",
              "lessThan": "624fa7baa378",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "33e03adafb29",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "a1700479524b",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "cec4e857ffaa",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "cc2edb99ea60",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "c8d5faee4624",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "0a31dd6fd2f4",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f4",
              "lessThan": "6bba4471f0cc",
              "status": "affected",
              "versionType": "git"
            }
          ]
        },
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "affected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "fs/ocfs2/file.c"
          ],
          "versions": [
            {
              "version": "4.4.272",
              "lessThanOrEqual": "4.4.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "4.9.272",
              "lessThanOrEqual": "4.9.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "4.14.236",
              "lessThanOrEqual": "4.14.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "4.19.194",
              "lessThanOrEqual": "4.19.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "5.4.125",
              "lessThanOrEqual": "5.4.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "5.10.43",
              "lessThanOrEqual": "5.10.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "5.12.10",
              "lessThanOrEqual": "5.12.*",
              "status": "unaffected",
              "versionType": "custom"
            },
            {
              "version": "5.13",
              "lessThanOrEqual": "*",
              "status": "unaffected",
              "versionType": "original_commit_for_fix"
            }
          ]
        }
      ],
      "references": [
        {
          "url": "https://git.kernel.org/stable/c/624fa7baa3788dc9e57840ba5b94bc22b03cda57"
        },
        {
          "url": "https://git.kernel.org/stable/c/33e03adafb29eedae1bae9cdb50c1385279fcf65"
        },
        {
          "url": "https://git.kernel.org/stable/c/a1700479524bb9cb5e8ae720236a6fabd003acae"
        },
        {
          "url": "https://git.kernel.org/stable/c/cec4e857ffaa8c447f51cd8ab4e72350077b6770"
        },
        {
          "url": "https://git.kernel.org/stable/c/cc2edb99ea606a45182b5ea38cc8f4e583aa0774"
        },
        {
          "url": "https://git.kernel.org/stable/c/c8d5faee46242c3f33b8a71a4d7d52214785bfcc"
        },
        {
          "url": "https://git.kernel.org/stable/c/0a31dd6fd2f4e7db538fb6eb1f06973d81f8dd3b"
        },
        {
          "url": "https://git.kernel.org/stable/c/6bba4471f0cc1296fe3c2089b9e52442d3074b2e"
        }
      ],
      "title": "ocfs2: fix data corruption by fallocate",
      "x_generator": {
        "engine": "bippy-a5840b7849dd"
      }
    },
    "adp": [
      {
        "metrics": [
          {
            "other": {
              "type": "ssvc",
              "content": {
                "id": "CVE-2021-47114",
                "role": "CISA Coordinator",
                "options": [
                  {
                    "Exploitation": "none"
                  },
                  {
                    "Automatable": "no"
                  },
                  {
                    "Technical Impact": "partial"
                  }
                ],
                "version": "2.0.3",
                "timestamp": "2024-03-18T14:57:08.882908Z"
              }
            }
          }
        ],
        "providerMetadata": {
          "orgId": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
          "shortName": "CISA-ADP",
          "dateUpdated": "2024-05-23T19:01:18.281Z"
        },
        "title": "CISA ADP Vulnrichment"
      }
    ]
  }
}