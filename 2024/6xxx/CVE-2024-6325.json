{
  "dataType": "CVE_RECORD",
  "containers": {
    "adp": [
      {
        "title": "CISA ADP Vulnrichment",
        "metrics": [
          {
            "other": {
              "type": "ssvc",
              "content": {
                "id": "CVE-2024-6325",
                "role": "CISA Coordinator",
                "options": [
                  {
                    "Exploitation": "none"
                  },
                  {
                    "Automatable": "no"
                  },
                  {
                    "Technical Impact": "partial"
                  }
                ],
                "version": "2.0.3",
                "timestamp": "2024-07-16T18:04:54.518272Z"
              }
            }
          }
        ],
        "providerMetadata": {
          "orgId": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
          "shortName": "CISA-ADP",
          "dateUpdated": "2024-07-16T18:05:22.843Z"
        }
      }
    ],
    "cna": {
      "title": "Rockwell Automation Unsecured Private Keys in FactoryTalk\u00ae System Services",
      "source": {
        "advisory": "SD1678",
        "discovery": "INTERNAL"
      },
      "impacts": [
        {
          "capecId": "CAPEC-122",
          "descriptions": [
            {
              "lang": "en",
              "value": "CAPEC-122 Privilege Abuse"
            }
          ]
        }
      ],
      "metrics": [
        {
          "format": "CVSS",
          "cvssV4_0": {
            "Safety": "NOT_DEFINED",
            "version": "4.0",
            "Recovery": "NOT_DEFINED",
            "baseScore": 6,
            "Automatable": "NOT_DEFINED",
            "attackVector": "LOCAL",
            "baseSeverity": "MEDIUM",
            "valueDensity": "NOT_DEFINED",
            "vectorString": "CVSS:4.0/AV:L/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:N/SC:H/SI:N/SA:N",
            "providerUrgency": "NOT_DEFINED",
            "userInteraction": "NONE",
            "attackComplexity": "LOW",
            "attackRequirements": "NONE",
            "privilegesRequired": "LOW",
            "subIntegrityImpact": "NONE",
            "vulnIntegrityImpact": "NONE",
            "subAvailabilityImpact": "NONE",
            "vulnAvailabilityImpact": "NONE",
            "subConfidentialityImpact": "HIGH",
            "vulnConfidentialityImpact": "NONE",
            "vulnerabilityResponseEffort": "NOT_DEFINED"
          },
          "scenarios": [
            {
              "lang": "en",
              "value": "GENERAL"
            }
          ]
        }
      ],
      "affected": [
        {
          "vendor": "Rockwell Automation",
          "product": "FactoryTalk\u00ae System Services (installed via FTPM)",
          "versions": [
            {
              "status": "affected",
              "version": "6.40"
            }
          ],
          "defaultStatus": "unaffected"
        },
        {
          "vendor": "Rockwell Automation",
          "product": "FactoryTalk\u00ae Policy Manager (FTPM)",
          "versions": [
            {
              "status": "affected",
              "version": "v6.40"
            }
          ],
          "defaultStatus": "unaffected"
        }
      ],
      "solutions": [
        {
          "lang": "en",
          "value": "Users using the affected software are encouraged to implement the following steps to invalidate the existing vulnerable private keys/digital certificates and regenerate new secure ones.\n\n Security Best Practices https://rockwellautomation.custhelp.com/app/answers/answer_view/a_id/1085012/loc/en_US#__highlight",
          "supportingMedia": [
            {
              "type": "text/html",
              "value": "\n\n<p>Users using the affected software are encouraged to implement the following steps to invalidate the existing vulnerable private keys/digital certificates and regenerate new secure ones.</p><p><a target=\"_blank\" rel=\"nofollow\"></a><a target=\"_blank\" rel=\"nofollow\"></a><a target=\"_blank\" rel=\"nofollow\"></a><a target=\"_blank\" rel=\"nofollow\">\u00b7 &nbsp; &nbsp; &nbsp; Clear CIP Security configurations from devices and from FactoryTalk\u00ae Policy Manager</a></p><p>\u00b7 &nbsp; &nbsp; &nbsp; Update FactoryTalk\u00ae System Services and FactoryTalk\u00ae Policy Manager to v6.40.01</p><p>\u00b7 &nbsp; &nbsp; &nbsp; Redeploy CIP Security Policy </p><p>Detailed steps are below <b>(FactoryTalk System Services (FTSS) is updated through the installation of FactoryTalk Policy Manager (FTPM)</b></p><p>1) &nbsp; &nbsp;  Remove deployed security policy from all devices using FactoryTalk\u00ae Policy Manager (FTPM):</p><p>a. &nbsp; &nbsp; &nbsp; Open FTPM.</p><p>b. &nbsp; &nbsp; &nbsp; Document all Zone\u2019s security settings and all Conduit\u2019s settings as you must re-create them after updating FTPM.</p><p>c. &nbsp; &nbsp; &nbsp; Change all devices port\u2019s Policies &gt; Zone values to the \u201cUnassigned\u201d Zone.</p><p>d. &nbsp; &nbsp; &nbsp; Delete all zones and conduits.</p><p>e. &nbsp; &nbsp; &nbsp; Deploy (CIP).  Ensure that all endpoints were reset successfully.</p><p>f. &nbsp; &nbsp; &nbsp;  [migrating from v6.40 only] Deploy (OPC UA).  Ensure all endpoints were reset successfully.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  i. &nbsp; &nbsp;  For any OPC UA clients, perform whatever steps are required by those clients to remove the previously applied certificates.</p><p>g. &nbsp; &nbsp; &nbsp; Close FTPM</p><p>2) &nbsp; &nbsp;  Delete the \\FTSS_backup folder:</p><p>a. &nbsp; &nbsp; &nbsp; c:\\ProgramData\\Rockwell\\RNAServer\\Global\\RnaStore\\FTSS_Backup</p><p>3) &nbsp; &nbsp;  Delete the \\keystore folder:</p><p>a. &nbsp; &nbsp; &nbsp; c:\\ProgramData\\Rockwell Automation\\FactoryTalk System Services\\keystore</p><p>4) &nbsp; &nbsp;  Delete any backup copies of the \\keystore folder.  They will be named the same as the \\keystore folder but with a suffix appended to it, like:</p><p>a. &nbsp; &nbsp; &nbsp; c:\\ProgramData\\Rockwell Automation\\FactoryTalk System Services\\ keystore_source_2024_04_25_12_25_38_541566</p><p>5) &nbsp; &nbsp;  Delete the PSKs.json file:</p><p>a. &nbsp; &nbsp; &nbsp; c:\\ProgramData\\Rockwell Automation\\FactoryTalk System Services\\PSKs.json</p><p>6) &nbsp; &nbsp;  Delete any backup copies of the PSKs.json file.  They will be named the same as the PSKs.json file but with a suffix appended to it, like:</p><p>a. &nbsp; &nbsp; &nbsp; c:\\ProgramData\\Rockwell Automation\\FactoryTalk System Services\\ PSKs.json_source_2024_05_17_07_38_25_200356</p><p>7) &nbsp; &nbsp;  Install FactoryTalk\u00ae Policy Manager version 6.40.01.</p><p>a. &nbsp; &nbsp; &nbsp; Restart the computer when prompted at the end of the install.</p><p>8) &nbsp; &nbsp;  Open FTPM.  FTPM will attempt to connect to the FactoryTalk\u00ae System Services web server before proceeding.</p><p>9) &nbsp; &nbsp;  If FTPM could not successfully connect to FactoryTalk\u00ae System Services (FTSS), it is because the FTSS service hasn\u2019t started yet.  It will eventually start or else you can start the FTSS service manually in Windows Services.</p><p>10) &nbsp; Re-create the original Zones.</p><p>11) &nbsp; Move the devices from the unassigned Zone back to their original zones.</p><p>12) &nbsp; Re-create the original Conduits.</p><p>13) &nbsp; Deploy (CIP endpoints).</p><p>14) &nbsp; [migrating from v6.40 only] Deploy (OPC UA endpoints).</p><p>a. &nbsp; &nbsp; &nbsp; For any OPC UA client endpoints, manually apply the newly generated certificates from this deploy.</p><p>Additionally, we encourage customers to implement our suggested security best practices to minimize the risk of vulnerability.</p><p>\u00b7 &nbsp; &nbsp; &nbsp; <a target=\"_blank\" rel=\"nofollow\" href=\"https://rockwellautomation.custhelp.com/app/answers/answer_view/a_id/1085012/loc/en_US#__highlight\">Security Best Practices</a></p>\n\n<br>",
              "base64": false
            }
          ]
        }
      ],
      "datePublic": "2024-07-11T13:00:00.000Z",
      "references": [
        {
          "url": "https://www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.SD1678.html"
        }
      ],
      "x_generator": {
        "engine": "Vulnogram 0.2.0"
      },
      "descriptions": [
        {
          "lang": "en",
          "value": "The v6.40 release of Rockwell Automation FactoryTalk\u00ae Policy Manager CVE-2021-22681 https://www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1550.html \u00a0and  CVE-2022-1161 https://www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1585.html \u00a0by implementing CIP security and did not update to the versions of the software CVE-2022-1161 https://www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1585.html \u00a0and  CVE-2022-1161. https://www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1585.html",
          "supportingMedia": [
            {
              "type": "text/html",
              "value": "\n\n<span style=\"background-color: rgb(255, 255, 255);\">The v6.40 release of Rockwell Automation FactoryTalk\u00ae Policy Manager</span><a target=\"_blank\" rel=\"nofollow\">&nbsp;allowed </a><span style=\"background-color: rgb(255, 255, 255);\">the private keys to be insecurely stored with read and execute privileges for the Windows group, \u2018Everyone\u2019. These keys are used to generate digital certificates and pre-shared keys. This vulnerability could allow a malicious user with access to the machine to obtain private keys. If obtained, a malicious user could impersonate resources on the secured network. </span><a target=\"_blank\" rel=\"nofollow\"></a><a target=\"_blank\" rel=\"nofollow\"></a><a target=\"_blank\" rel=\"nofollow\"></a><a target=\"_blank\" rel=\"nofollow\"></a><a target=\"_blank\" rel=\"nofollow\">For customers</a><span style=\"background-color: rgb(255, 255, 255);\">&nbsp;using FactoryTalk\u00ae Policy Manager v6.40 who mitigated</span><a target=\"_blank\" rel=\"nofollow\"></a><a target=\"_blank\" rel=\"nofollow\">&nbsp;</a><a target=\"_blank\" rel=\"nofollow\" href=\"https://www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1550.html\">CVE-2021-22681</a><span style=\"background-color: rgb(255, 255, 255);\">&nbsp;and </span><a target=\"_blank\" rel=\"nofollow\" href=\"https://www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1585.html\">CVE-2022-1161</a><span style=\"background-color: rgb(255, 255, 255);\">&nbsp;by implementing CIP security and did not update to the versions of the software</span><a target=\"_blank\" rel=\"nofollow\">&nbsp;</a><span style=\"background-color: rgb(255, 255, 255);\">that contain the remediation, this vulnerability could allow a threat actor to exploit </span><a target=\"_blank\" rel=\"nofollow\" href=\"https://www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1585.html\">CVE-2022-1161</a><span style=\"background-color: rgb(255, 255, 255);\">&nbsp;and </span><a target=\"_blank\" rel=\"nofollow\" href=\"https://www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1585.html\">CVE-2022-1161.</a>\n\n",
              "base64": false
            }
          ]
        }
      ],
      "problemTypes": [
        {
          "descriptions": [
            {
              "lang": "en",
              "type": "CWE",
              "cweId": "CWE-269",
              "description": "CWE-269 Improper Privilege Management"
            }
          ]
        }
      ],
      "providerMetadata": {
        "orgId": "b73dd486-f505-4403-b634-40b078b177f0",
        "shortName": "Rockwell",
        "dateUpdated": "2024-07-16T16:43:44.494Z"
      }
    }
  },
  "cveMetadata": {
    "cveId": "CVE-2024-6325",
    "state": "PUBLISHED",
    "dateUpdated": "2024-07-17T15:47:32.018Z",
    "dateReserved": "2024-06-25T15:13:41.907Z",
    "assignerOrgId": "b73dd486-f505-4403-b634-40b078b177f0",
    "datePublished": "2024-07-16T16:43:44.494Z",
    "assignerShortName": "Rockwell"
  },
  "dataVersion": "5.1"
}