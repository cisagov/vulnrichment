{
  "dataType": "CVE_RECORD",
  "containers": {
    "cna": {
      "title": "Prompt Injection in \"ask\" API with visualization leads to RCE",
      "source": {
        "discovery": "EXTERNAL"
      },
      "metrics": [
        {
          "format": "CVSS",
          "cvssV3_1": {
            "scope": "UNCHANGED",
            "version": "3.1",
            "baseScore": 8.1,
            "attackVector": "NETWORK",
            "baseSeverity": "HIGH",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "integrityImpact": "HIGH",
            "userInteraction": "NONE",
            "attackComplexity": "HIGH",
            "availabilityImpact": "HIGH",
            "privilegesRequired": "NONE",
            "confidentialityImpact": "HIGH"
          },
          "scenarios": [
            {
              "lang": "en",
              "value": "GENERAL"
            }
          ]
        }
      ],
      "affected": [
        {
          "versions": [
            {
              "status": "affected",
              "version": "0",
              "versionType": "python"
            }
          ],
          "packageName": "vanna",
          "collectionURL": "https://pypi.org/project/pip",
          "defaultStatus": "affected"
        }
      ],
      "references": [
        {
          "url": "https://research.jfrog.com/vulnerabilities/vanna-prompt-injection-rce-jfsa-2024-001034449/",
          "tags": [
            "third-party-advisory"
          ]
        }
      ],
      "descriptions": [
        {
          "lang": "en",
          "value": "The Vanna library uses a prompt function to present the user with visualized results, it is possible to alter the prompt using prompt injection and run arbitrary Python code instead of the intended visualization code. Specifically - allowing external input to the library\u2019s \u201cask\u201d method with \"visualize\" set to True (default behavior) leads to remote code execution.",
          "supportingMedia": [
            {
              "type": "text/html",
              "value": "<p>The Vanna library uses a prompt function to present the user with visualized results, it is possible to alter the prompt using prompt injection and run arbitrary Python code instead of the intended visualization code. Specifically - allowing external input to the library\u2019s \u201cask\u201d method with \"visualize\" set to True (default behavior) leads to remote code execution.</p>",
              "base64": false
            }
          ]
        }
      ],
      "providerMetadata": {
        "orgId": "48a46f29-ae42-4e1d-90dd-c1676c1e5e6d",
        "shortName": "JFROG",
        "dateUpdated": "2024-05-31T14:24:21.663Z"
      }
    },
    "adp": [
      {
        "metrics": [
          {
            "other": {
              "type": "ssvc",
              "content": {
                "id": "CVE-2024-5565",
                "role": "CISA Coordinator",
                "options": [
                  {
                    "Exploitation": "poc"
                  },
                  {
                    "Automatable": "no"
                  },
                  {
                    "Technical Impact": "total"
                  }
                ],
                "version": "2.0.3",
                "timestamp": "2024-05-31T16:06:06.334889Z"
              }
            }
          }
        ],
        "affected": [
          {
            "cpes": [
              "cpe:2.3:a:vanna-ai:vanna:-:*:*:*:*:*:*:*"
            ],
            "vendor": "vanna-ai",
            "product": "vanna",
            "versions": [
              {
                "status": "affected",
                "version": "-"
              }
            ],
            "defaultStatus": "unknown"
          }
        ],
        "problemTypes": [
          {
            "descriptions": [
              {
                "lang": "en",
                "type": "CWE",
                "cweId": "CWE-94",
                "description": "CWE-94 Improper Control of Generation of Code ('Code Injection')"
              }
            ]
          }
        ],
        "providerMetadata": {
          "shortName": "CISAADP",
          "orgId": "8c464350-323a-4346-a867-fc54517fa145",
          "dateUpdated": "2024-05-31T16:08:29.286Z"
        }
      }
    ]
  },
  "cveMetadata": {
    "cveId": "CVE-2024-5565",
    "state": "PUBLISHED",
    "dateUpdated": "2024-05-31T14:24:21.663Z",
    "dateReserved": "2024-05-31T13:56:13.026Z",
    "assignerOrgId": "48a46f29-ae42-4e1d-90dd-c1676c1e5e6d",
    "datePublished": "2024-05-31T14:24:21.663Z",
    "assignerShortName": "JFROG"
  },
  "dataVersion": "5.1"
}